flowchart TD

    %% Background Styling
    classDef background fill:#202020,stroke:#333,stroke-width:2px,color:#ffffff;

    %% Data Collection (Top-Centered)
    subgraph DC["ðŸ” 1. Data Collection"]
        direction TB
        class DC background;
        B["ðŸ“± Benign APKs"]
        M["âš ï¸ Malicious APKs"]
    end

    %% Static Analysis (Left)
    subgraph SA["ðŸ›  2. Static Analysis"]
        direction TB
        class SA background;
        AD["ðŸ“¦ APK Decompilation"]
        FE["ðŸ”Ž Feature Extraction"]
        MT["ðŸ“Š Model Training"]
        DR["ðŸ“Œ Initial Detection"]
    end

    %% Dynamic Analysis (Right)
    subgraph DA["âš¡ 3. Dynamic Analysis"]
        direction TB
        class DA background;
        AI["ðŸ“² APK Installation"]
        RM["ðŸ“¡ Runtime Monitoring"]
        
        subgraph RM_Elements["ðŸ” Monitoring Elements"]
            direction LR
            API["ðŸ“ž API Calls"]
            PU["ðŸ”‘ Permissions"]
            SL["âš ï¸ Logs"]
            BD["ðŸ”‹ Battery & CPU"]
        end
        
        BFE["ðŸ§ª Behavioral Features"]
        SDR["ðŸ“Œ Secondary Detection"]
    end

    %% Combined Classification (Center)
    subgraph CC["ðŸ”„ 4. Combined Classification"]
        direction TB
        class CC background;
        SA_DA["ðŸ”€ Static + Dynamic Merge"]
        FD{{"ðŸŽ¯ Final Decision"}}
        
        subgraph Dec["âœ…âŒ Decision Outcomes"]
            direction LR
            Ben["âœ… Benign"]
            Mal["âŒ Malicious"]
        end
    end

    %% User Platform (Bottom-Centered)
    subgraph UP["ðŸš€ 5. User-Friendly Platform"]
        direction TB
        class UP background;
        UU["ðŸ“¤ User Uploads APK"]
        RSD["ðŸ”„ Real-time Analysis"]
        MCR{{"ðŸš¦ Classification Result"}}
        
        subgraph Res["ðŸ“¢ User Feedback"]
            direction TB
            Ben2["âœ… Benign - Safe to Install"]
            Mal2["âŒ Malicious (Risk Factors)"]
        end
    end

    %% Connections (Symmetrically Balanced)
    B --> AD
    M --> AD
    M --> AI
    
    AD --> FE
    FE --> MT
    MT --> DR

    AI --> RM
    RM --- API & PU & SL & BD
    RM --> BFE
    BFE --> SDR

    DR --> SA_DA
    SDR --> SA_DA
    SA_DA --> FD
    FD --> Ben & Mal

    FD --> UP
    UU --> RSD
    RSD --> MCR
    MCR --> Ben2
    MCR --> Mal2

    %% Styling for Visual Appeal
    classDef processNode fill:#455A64,stroke:#1a5fb4,stroke-width:2px,color:#fff,rounded:10px;
    classDef decisionNode fill:#FF9800,stroke:#c64600,stroke-width:2px,color:#fff,rounded:15px;
    classDef subgraphStyle fill:#37474F,stroke:#f5f5f5,stroke-width:1px,color:#f5f5f5,rounded:10px;
    classDef positiveNode fill:#4CAF50,stroke:#26a269,stroke-width:1px,color:#fff,rounded:5px;
    classDef negativeNode fill:#F44336,stroke:#c01c28,stroke-width:1px,color:#fff,rounded:5px;

    class AD,FE,MT,AI,RM,BFE,UU,RSD processNode;
    class DR,SDR,FD,MCR decisionNode;
    class Ben,Ben2 positiveNode;
    class Mal,Mal2 negativeNode;
    class DC,SA,DA,CC,UP subgraphStyle;
